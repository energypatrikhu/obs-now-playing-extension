(function () {
	'use strict';

	function J(e,t){return t===void 0&&(t=e,e=document),e.querySelector(t)}async function A(e,t){return new Promise(r=>{t===void 0&&(t=e,e=document);let n=J(e,t);if(n){r(n);return}const i=new MutationObserver(()=>{n=J(e,t),n&&(i.disconnect(),r(n));});i.observe(e,{childList:!0,subtree:!0});})}let I;function oe(e){new MutationObserver(()=>{const t=location.href;I!==t&&(I=t,e&&e(I));}).observe(document.body,{childList:!0,subtree:!0});}var c={},T={};Object.defineProperty(T,"__esModule",{value:!0});T.allChars=void 0;T.allChars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";var j={};Object.defineProperty(j,"__esModule",{value:!0});j.anyHas=void 0;function ue(e,t=null,r=null){if(r!==null){if(typeof r=="string"&&e.includes(r))return !1;if(typeof r=="object"){for(let n of r)if(e.includes(n)&&n!="")return !1}}if(t!==null){if(typeof t=="string"&&e.includes(t))return !0;if(typeof t=="object"){for(let n of t)if(e.includes(n)&&n!="")return !0}}return !1}j.anyHas=ue;var w={};Object.defineProperty(w,"__esModule",{value:!0});w.approx=void 0;function ce(e,t,r=5){return Math.abs(e-t)<r}w.approx=ce;var M={};Object.defineProperty(M,"__esModule",{value:!0});M.awaitValue=void 0;async function le(e,t){return new Promise(r=>{const n=setInterval(async()=>{if(await e()===t){clearInterval(n),r(t);return}},0);})}M.awaitValue=le;var v={};Object.defineProperty(v,"__esModule",{value:!0});v.compareNumbers=v.compareVersions=void 0;function fe(e,t){if(e===t)return 0;const r=e.toString().match(/\d+/g),n=t.toString().match(/\d+/g);for(let i=0;i<Math.min(r.length,n.length);i++){const o=parseInt(r[i]),f=parseInt(n[i]);if(o>f)return 1;if(o<f)return -1}return 0}v.compareVersions=fe;function se(e,t){if(e===t)return 0;const r=parseInt(e),n=parseInt(t);return r>n?1:r<n?-1:0}v.compareNumbers=se;var B={};Object.defineProperty(B,"__esModule",{value:!0});B.convertFileSize=void 0;function me(e,t){if(e===0)return "0 B";const r=1024,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(r));return `${(e/Math.pow(r,i)).toFixed(t)} ${n[i]}`}B.convertFileSize=me;var y={};Object.defineProperty(y,"__esModule",{value:!0});y.getDateTimeString=y.getCurrentTime=void 0;function W(){return new Intl.DateTimeFormat("hu-HU",{timeZone:"Europe/Budapest",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date)}y.getCurrentTime=W;function de(){return W().replace(/(\.\s|:|,)/g,".")}y.getDateTimeString=de;var O={};Object.defineProperty(O,"__esModule",{value:!0});O.getTimestamp=void 0;function ge(){return new Date().toISOString().slice(0,19).replace("T"," ")}O.getTimestamp=ge;var N={};Object.defineProperty(N,"__esModule",{value:!0});N.BJSON=void 0;class pe{replacer(t,r){return r instanceof Set?{dataType:"Set",value:[...r]}:r instanceof Map?{dataType:"Map",value:Object.fromEntries(r)}:r}reviver(t,r){if(r!==null&&typeof r=="object"&&!Array.isArray(r)&&"dataType"in r)switch(r.dataType){case"Set":return new Set(r.value);case"Map":return new Map(Object.entries(r.value));default:return r}return r}parse(t){return JSON.parse(t,this.reviver)}stringify(t,r){return JSON.stringify(t,this.replacer,r)}}N.BJSON=new pe;var P={};Object.defineProperty(P,"__esModule",{value:!0});P.logger=void 0;const be=O,ve={info:"[INFO]",warn:"[WARNING]",error:"[ERROR]"};function ye(e){return typeof window<"u"&&typeof window.document<"u"&&e instanceof Element?!1:typeof e=="object"&&e!==null}function Se(e,...t){const r=t.map(i=>ye(i)?JSON.stringify(i,null,"	"):i),n=`[${(0, be.getTimestamp)()}] ${ve[e]}`;return console.log(n,...r),n+" "+r.join(" ")}P.logger=Se;var _={};Object.defineProperty(_,"__esModule",{value:!0});_.numPrefix=void 0;function he(e,t=0){return "0".repeat(t-(t>1?e.toString().length:1))+e}_.numPrefix=he;var l={};Object.defineProperty(l,"__esModule",{value:!0});l.B64ToStr=l.StrToB64=l.B64ToObj=l.ObjToB64=void 0;function Te(e){return G(JSON.stringify(e))}l.ObjToB64=Te;function Oe(e){return JSON.parse(Z(e))}l.B64ToObj=Oe;function G(e){return Buffer.from(e).toString("base64url")}l.StrToB64=G;function Z(e){return Buffer.from(e,"base64url").toString("utf-8")}l.B64ToStr=Z;var S={};Object.defineProperty(S,"__esModule",{value:!0});S.parallelForEach=S.debugMode=void 0;const Pe=P;let K=!1;function z(...e){K&&(0, Pe.logger)("info","[e-utils:parallelForEach]",...e);}function _e(e){K=e;}S.debugMode=_e;function je(e,t,r){return new Promise(n=>{const i=(r==null?void 0:r.maxWorkers)||2;z(`Using ${i} workers`);let o;e instanceof Map?o=new Set([...e.entries()].map(([a,u])=>({index:a,state:"pending",value:u}))):e instanceof Set?o=new Set([...e].map((a,u)=>({index:u,state:"pending",value:a}))):o=new Set(e.map((a,u)=>({index:u,state:"pending",value:a})));const f=()=>[...o.values()].find(a=>a.state==="pending"),p=a=>[...o.values()].filter(u=>u.state===a).length,m=a=>{z("Removing entry");const u=[...o.values()].find(b=>b.index===a);u&&o.delete(u),o.size===0&&n();},d=async()=>{if(o.size===0||p("processing")===i)return;const a=f();!a||(a.state="processing",z("Starting process"),await t(a.value),m(a.index),d());};for(let a=0;a<i;a++)d();})}S.parallelForEach=je;var C={};Object.defineProperty(C,"__esModule",{value:!0});C.parseSearchParams=void 0;function we(e){const t={};for(let[r,n]of e.entries())r.endsWith("[]")?(r=r.slice(0,-2),r in t?t[r].push(n):t[r]=[n]):t[r]=n;return t}C.parseSearchParams=we;var h={};Object.defineProperty(h,"__esModule",{value:!0});h.randomNumber=void 0;function Me(e,t){return t===void 0&&(t=e,e=0),Math.floor(Math.random()*(t-e+1))+e}h.randomNumber=Me;var $={};Object.defineProperty($,"__esModule",{value:!0});$.randomString=void 0;const k=T;function Be(e=16){let t="";for(let r=0;r<e;r++){const n=Math.floor(Math.random()*k.allChars.length);t+=k.allChars.charAt(n);}return t}$.randomString=Be;var F={};Object.defineProperty(F,"__esModule",{value:!0});F.secToTime=void 0;const Ne=_;function Ce(e,t="{HH}:{MM}:{SS}"){e<0&&(e=0);const r=Math.floor(e/(60**2*24)),n=Math.floor(e%(60**2*24)/60**2),i=Math.floor(e%60**2/60),o=Math.floor(e%60),f={D:r,H:n,M:i,S:o},p=t.match(/\{(D{1,}|H{1,}|M{1,}|S{1,})\}/g);for(const m of p){const d=m.substring(1,m.length-1);t=t.replace(m,(0, Ne.numPrefix)(f[d[0]],d.length));}return t}F.secToTime=Ce;var V={};Object.defineProperty(V,"__esModule",{value:!0});V.shuffleString=void 0;const $e=h;function Fe(e){const t=e.split("");for(let r=t.length-1;r>0;r--){const n=(0, $e.randomNumber)(r+1);[t[r],t[n]]=[t[n],t[r]];}return t.join("")}V.shuffleString=Fe;var D={};Object.defineProperty(D,"__esModule",{value:!0});D.sleep=void 0;const Ve=h;function De(e,t){const r=Math.abs(e)+(t?(0, Ve.randomNumber)(Math.abs(t-e+1)):0);return new Promise(n=>setTimeout(n,r))}D.sleep=De;var E={};Object.defineProperty(E,"__esModule",{value:!0});E.textReplacer=void 0;function Ee(e,...t){for(const[r,n]of t.entries())e=e.replace(`{${r}}`,n);return e}E.textReplacer=Ee;var R={};Object.defineProperty(R,"__esModule",{value:!0});R.timeToSec=void 0;function Re(e){return e.split(":").reverse().map((t,r)=>r!=0?parseInt(t)*60**r:parseInt(t)).reduce((t,r)=>t+r)}R.timeToSec=Re;var H={};Object.defineProperty(H,"__esModule",{value:!0});H.queryString=void 0;function He(e){return new URLSearchParams(e).toString()}H.queryString=He;(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.queryString=e.timeToSec=e.textReplacer=e.sleep=e.shuffleString=e.secToTime=e.randomString=e.randomNumber=e.parseSearchParams=e.parallelForEach=e.B64ToStr=e.StrToB64=e.B64ToObj=e.ObjToB64=e.numPrefix=e.logger=e.BJSON=e.getTimestamp=e.getDateTimeString=e.getCurrentTime=e.convertFileSize=e.compareNumbers=e.compareVersions=e.awaitValue=e.approx=e.anyHas=e.allChars=void 0;var t=T;Object.defineProperty(e,"allChars",{enumerable:!0,get:function(){return t.allChars}});var r=j;Object.defineProperty(e,"anyHas",{enumerable:!0,get:function(){return r.anyHas}});var n=w;Object.defineProperty(e,"approx",{enumerable:!0,get:function(){return n.approx}});var i=M;Object.defineProperty(e,"awaitValue",{enumerable:!0,get:function(){return i.awaitValue}});var o=v;Object.defineProperty(e,"compareVersions",{enumerable:!0,get:function(){return o.compareVersions}}),Object.defineProperty(e,"compareNumbers",{enumerable:!0,get:function(){return o.compareNumbers}});var f=B;Object.defineProperty(e,"convertFileSize",{enumerable:!0,get:function(){return f.convertFileSize}});var p=y;Object.defineProperty(e,"getCurrentTime",{enumerable:!0,get:function(){return p.getCurrentTime}}),Object.defineProperty(e,"getDateTimeString",{enumerable:!0,get:function(){return p.getDateTimeString}});var m=O;Object.defineProperty(e,"getTimestamp",{enumerable:!0,get:function(){return m.getTimestamp}});var d=N;Object.defineProperty(e,"BJSON",{enumerable:!0,get:function(){return d.BJSON}});var a=P;Object.defineProperty(e,"logger",{enumerable:!0,get:function(){return a.logger}});var u=_;Object.defineProperty(e,"numPrefix",{enumerable:!0,get:function(){return u.numPrefix}});var b=l;Object.defineProperty(e,"ObjToB64",{enumerable:!0,get:function(){return b.ObjToB64}}),Object.defineProperty(e,"B64ToObj",{enumerable:!0,get:function(){return b.B64ToObj}}),Object.defineProperty(e,"StrToB64",{enumerable:!0,get:function(){return b.StrToB64}}),Object.defineProperty(e,"B64ToStr",{enumerable:!0,get:function(){return b.B64ToStr}});var Q=S;Object.defineProperty(e,"parallelForEach",{enumerable:!0,get:function(){return Q.parallelForEach}});var X=C;Object.defineProperty(e,"parseSearchParams",{enumerable:!0,get:function(){return X.parseSearchParams}});var Y=h;Object.defineProperty(e,"randomNumber",{enumerable:!0,get:function(){return Y.randomNumber}});var x=$;Object.defineProperty(e,"randomString",{enumerable:!0,get:function(){return x.randomString}});var ee=F;Object.defineProperty(e,"secToTime",{enumerable:!0,get:function(){return ee.secToTime}});var te=V;Object.defineProperty(e,"shuffleString",{enumerable:!0,get:function(){return te.shuffleString}});var re=D;Object.defineProperty(e,"sleep",{enumerable:!0,get:function(){return re.sleep}});var ne=E;Object.defineProperty(e,"textReplacer",{enumerable:!0,get:function(){return ne.textReplacer}});var ie=R;Object.defineProperty(e,"timeToSec",{enumerable:!0,get:function(){return ie.timeToSec}});var ae=H;Object.defineProperty(e,"queryString",{enumerable:!0,get:function(){return ae.queryString}});})(c);const Ie="http://127.0.0.1:2442/api/nowPlaying";let ze=49.2,[L,U,g]=[null,null,null],q=!1;async function qe(e,t){await fetch(Ie,{method:"POST",body:JSON.stringify({videoId:e,time:t}),headers:{"Content-Type":"application/json"}});}async function s(e){if(e){const n=await A(".time-info.style-scope.ytmusic-player-bar");if(!n.textContent)return await c.sleep(100),await s(e);if(!n.textContent.trim())return await c.sleep(100),await s(e);if(n.textContent.trim().split(" / ").length===0)return await c.sleep(100),await s(e);const i=n.textContent.trim().split(" / ")[1];return c.timeToSec(i)===0?(await c.sleep(100),await s(e)):i}const t=await A(".ytp-time-duration");if(!t.textContent)return await c.sleep(100),await s(e);if(!t.textContent.trim())return await c.sleep(100),await s(e);const r=t.textContent.trim();return c.timeToSec(r)===0?(await c.sleep(100),await s(e)):r}oe(async e=>{if(!e.includes("watch")||q||(q=!0,g=new URLSearchParams(window.location.search).get("v"),g===null)||g===L)return;const r=window.location.hostname=="music.youtube.com";L=g;const n=await s(r),i=(Date.now()/1e3+(c.timeToSec(n)-ze))*1e3;console.log(`VideoID changed from '${U}' to '${g}'`),console.log("Time:",n,"| Seconds:",c.timeToSec(n),"| reAlert:",i),console.log("Data changed, sending new data to server"),await qe(g,i),U=g,q=!1;});

})();
